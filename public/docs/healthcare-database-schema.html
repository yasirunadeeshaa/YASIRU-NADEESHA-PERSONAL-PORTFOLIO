<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthcare System - Database Schema</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .schema-container {
            width: 100%;
            overflow-x: auto;
        }
        .database-schema {
            width: 100%;
            min-width: 1400px;
            height: 1200px;
        }
        .legend {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section {
            margin: 40px 0;
        }
        .section h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .table-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .table-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        .table-card h3 {
            color: #2c3e50;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .table-card table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .table-card th, .table-card td {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid #e0e0e0;
        }
        .table-card th {
            background: #e9ecef;
            font-weight: bold;
            font-size: 12px;
        }
        .table-card td {
            font-size: 12px;
        }
        .key-icon {
            color: #f39c12;
            font-size: 14px;
        }
        .foreign-key {
            color: #3498db;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Healthcare Appointment System</h1>
        <p class="subtitle">Database Schema Design</p>
        
        <div class="schema-container">
            <svg class="database-schema" viewBox="0 0 1400 1200">
                <!-- Define patterns and markers -->
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#666"/>
                    </marker>
                    <marker id="many" markerWidth="20" markerHeight="20" refX="15" refY="10" orient="auto">
                        <path d="M0,10 L15,10 M10,5 L15,10 L10,15" stroke="#666" fill="none"/>
                    </marker>
                </defs>
                
                <!-- Users Table -->
                <g id="users-table">
                    <rect x="50" y="50" width="220" height="200" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="4"/>
                    <rect x="50" y="50" width="220" height="30" fill="#1976d2"/>
                    <text x="160" y="70" text-anchor="middle" fill="white" font-weight="bold">users</text>
                    <text x="60" y="100" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="60" y="120" font-size="12">email: VARCHAR(255)</text>
                    <text x="60" y="140" font-size="12">password_hash: VARCHAR(255)</text>
                    <text x="60" y="160" font-size="12">role: ENUM</text>
                    <text x="60" y="180" font-size="12">is_active: BOOLEAN</text>
                    <text x="60" y="200" font-size="12">email_verified: BOOLEAN</text>
                    <text x="60" y="220" font-size="12">created_at: TIMESTAMP</text>
                    <text x="60" y="240" font-size="12">updated_at: TIMESTAMP</text>
                </g>
                
                <!-- Patient Profiles Table -->
                <g id="patient-profiles-table">
                    <rect x="350" y="50" width="240" height="280" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="4"/>
                    <rect x="350" y="50" width="240" height="30" fill="#4caf50"/>
                    <text x="470" y="70" text-anchor="middle" fill="white" font-weight="bold">patient_profiles</text>
                    <text x="360" y="100" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="360" y="120" font-size="12" fill="#3498db">ðŸ”— user_id: UUID</text>
                    <text x="360" y="140" font-size="12">first_name: VARCHAR(100)</text>
                    <text x="360" y="160" font-size="12">last_name: VARCHAR(100)</text>
                    <text x="360" y="180" font-size="12">date_of_birth: DATE</text>
                    <text x="360" y="200" font-size="12">gender: ENUM</text>
                    <text x="360" y="220" font-size="12">phone_number: VARCHAR(20)</text>
                    <text x="360" y="240" font-size="12">blood_type: VARCHAR(5)</text>
                    <text x="360" y="260" font-size="12">allergies: TEXT</text>
                    <text x="360" y="280" font-size="12">chronic_conditions: TEXT</text>
                    <text x="360" y="300" font-size="12">emergency_contact: JSON</text>
                    <text x="360" y="320" font-size="12">address: JSON</text>
                </g>
                
                <!-- Doctor Profiles Table -->
                <g id="doctor-profiles-table">
                    <rect x="650" y="50" width="260" height="320" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="4"/>
                    <rect x="650" y="50" width="260" height="30" fill="#ff9800"/>
                    <text x="780" y="70" text-anchor="middle" fill="white" font-weight="bold">doctor_profiles</text>
                    <text x="660" y="100" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="660" y="120" font-size="12" fill="#3498db">ðŸ”— user_id: UUID</text>
                    <text x="660" y="140" font-size="12">first_name: VARCHAR(100)</text>
                    <text x="660" y="160" font-size="12">last_name: VARCHAR(100)</text>
                    <text x="660" y="180" font-size="12">specialization: VARCHAR(100)</text>
                    <text x="660" y="200" font-size="12">qualification: VARCHAR(255)</text>
                    <text x="660" y="220" font-size="12">experience_years: INT</text>
                    <text x="660" y="240" font-size="12">license_number: VARCHAR(50)</text>
                    <text x="660" y="260" font-size="12">consultation_fee: DECIMAL</text>
                    <text x="660" y="280" font-size="12">rating: DECIMAL(3,2)</text>
                    <text x="660" y="300" font-size="12">total_reviews: INT</text>
                    <text x="660" y="320" font-size="12">languages: JSON</text>
                    <text x="660" y="340" font-size="12">education: JSON</text>
                    <text x="660" y="360" font-size="12">availability: JSON</text>
                </g>
                
                <!-- Appointments Table -->
                <g id="appointments-table">
                    <rect x="350" y="420" width="260" height="300" fill="#fce4ec" stroke="#e91e63" stroke-width="2" rx="4"/>
                    <rect x="350" y="420" width="260" height="30" fill="#e91e63"/>
                    <text x="480" y="440" text-anchor="middle" fill="white" font-weight="bold">appointments</text>
                    <text x="360" y="470" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="360" y="490" font-size="12">booking_reference: VARCHAR(20)</text>
                    <text x="360" y="510" font-size="12" fill="#3498db">ðŸ”— patient_id: UUID</text>
                    <text x="360" y="530" font-size="12" fill="#3498db">ðŸ”— doctor_id: UUID</text>
                    <text x="360" y="550" font-size="12">appointment_date: DATE</text>
                    <text x="360" y="570" font-size="12">start_time: TIME</text>
                    <text x="360" y="590" font-size="12">end_time: TIME</text>
                    <text x="360" y="610" font-size="12">consultation_type: ENUM</text>
                    <text x="360" y="630" font-size="12">status: ENUM</text>
                    <text x="360" y="650" font-size="12">reason_for_visit: TEXT</text>
                    <text x="360" y="670" font-size="12">symptoms: JSON</text>
                    <text x="360" y="690" font-size="12">fee: DECIMAL</text>
                    <text x="360" y="710" font-size="12">created_at: TIMESTAMP</text>
                </g>
                
                <!-- Consultations Table -->
                <g id="consultations-table">
                    <rect x="700" y="420" width="250" height="240" fill="#e8eaf6" stroke="#673ab7" stroke-width="2" rx="4"/>
                    <rect x="700" y="420" width="250" height="30" fill="#673ab7"/>
                    <text x="825" y="440" text-anchor="middle" fill="white" font-weight="bold">consultations</text>
                    <text x="710" y="470" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="710" y="490" font-size="12" fill="#3498db">ðŸ”— appointment_id: UUID</text>
                    <text x="710" y="510" font-size="12">session_id: VARCHAR(100)</text>
                    <text x="710" y="530" font-size="12">start_time: TIMESTAMP</text>
                    <text x="710" y="550" font-size="12">end_time: TIMESTAMP</text>
                    <text x="710" y="570" font-size="12">duration: INT</text>
                    <text x="710" y="590" font-size="12">meeting_url: VARCHAR(255)</text>
                    <text x="710" y="610" font-size="12">recording_url: VARCHAR(255)</text>
                    <text x="710" y="630" font-size="12">summary: TEXT</text>
                    <text x="710" y="650" font-size="12">follow_up_required: BOOLEAN</text>
                </g>
                
                <!-- Prescriptions Table -->
                <g id="prescriptions-table">
                    <rect x="1000" y="420" width="260" height="280" fill="#efebe9" stroke="#795548" stroke-width="2" rx="4"/>
                    <rect x="1000" y="420" width="260" height="30" fill="#795548"/>
                    <text x="1130" y="440" text-anchor="middle" fill="white" font-weight="bold">prescriptions</text>
                    <text x="1010" y="470" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="1010" y="490" font-size="12">prescription_number: VARCHAR(20)</text>
                    <text x="1010" y="510" font-size="12" fill="#3498db">ðŸ”— consultation_id: UUID</text>
                    <text x="1010" y="530" font-size="12" fill="#3498db">ðŸ”— patient_id: UUID</text>
                    <text x="1010" y="550" font-size="12" fill="#3498db">ðŸ”— doctor_id: UUID</text>
                    <text x="1010" y="570" font-size="12">diagnosis: TEXT</text>
                    <text x="1010" y="590" font-size="12">medications: JSON</text>
                    <text x="1010" y="610" font-size="12">instructions: TEXT</text>
                    <text x="1010" y="630" font-size="12">valid_until: DATE</text>
                    <text x="1010" y="650" font-size="12">digital_signature: TEXT</text>
                    <text x="1010" y="670" font-size="12">created_at: TIMESTAMP</text>
                </g>
                
                <!-- Medical Records Table -->
                <g id="medical-records-table">
                    <rect x="50" y="420" width="250" height="220" fill="#e0f2f1" stroke="#009688" stroke-width="2" rx="4"/>
                    <rect x="50" y="420" width="250" height="30" fill="#009688"/>
                    <text x="175" y="440" text-anchor="middle" fill="white" font-weight="bold">medical_records</text>
                    <text x="60" y="470" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="60" y="490" font-size="12" fill="#3498db">ðŸ”— patient_id: UUID</text>
                    <text x="60" y="510" font-size="12">record_type: ENUM</text>
                    <text x="60" y="530" font-size="12">title: VARCHAR(255)</text>
                    <text x="60" y="550" font-size="12">file_url: VARCHAR(500)</text>
                    <text x="60" y="570" font-size="12">file_size: BIGINT</text>
                    <text x="60" y="590" font-size="12">mime_type: VARCHAR(100)</text>
                    <text x="60" y="610" font-size="12">record_date: DATE</text>
                    <text x="60" y="630" font-size="12">uploaded_at: TIMESTAMP</text>
                </g>
                
                <!-- Payments Table -->
                <g id="payments-table">
                    <rect x="50" y="770" width="250" height="260" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="4"/>
                    <rect x="50" y="770" width="250" height="30" fill="#f44336"/>
                    <text x="175" y="790" text-anchor="middle" fill="white" font-weight="bold">payments</text>
                    <text x="60" y="820" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="60" y="840" font-size="12">transaction_id: VARCHAR(100)</text>
                    <text x="60" y="860" font-size="12" fill="#3498db">ðŸ”— appointment_id: UUID</text>
                    <text x="60" y="880" font-size="12" fill="#3498db">ðŸ”— patient_id: UUID</text>
                    <text x="60" y="900" font-size="12">amount: DECIMAL(10,2)</text>
                    <text x="60" y="920" font-size="12">currency: VARCHAR(3)</text>
                    <text x="60" y="940" font-size="12">payment_method: ENUM</text>
                    <text x="60" y="960" font-size="12">status: ENUM</text>
                    <text x="60" y="980" font-size="12">gateway_response: JSON</text>
                    <text x="60" y="1000" font-size="12">processed_at: TIMESTAMP</text>
                    <text x="60" y="1020" font-size="12">refund_amount: DECIMAL</text>
                </g>
                
                <!-- Time Slots Table -->
                <g id="time-slots-table">
                    <rect x="700" y="770" width="250" height="200" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="4"/>
                    <rect x="700" y="770" width="250" height="30" fill="#9c27b0"/>
                    <text x="825" y="790" text-anchor="middle" fill="white" font-weight="bold">time_slots</text>
                    <text x="710" y="820" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="710" y="840" font-size="12" fill="#3498db">ðŸ”— doctor_id: UUID</text>
                    <text x="710" y="860" font-size="12">day_of_week: ENUM</text>
                    <text x="710" y="880" font-size="12">start_time: TIME</text>
                    <text x="710" y="900" font-size="12">end_time: TIME</text>
                    <text x="710" y="920" font-size="12">slot_duration: INT</text>
                    <text x="710" y="940" font-size="12">is_available: BOOLEAN</text>
                    <text x="710" y="960" font-size="12">consultation_type: ENUM</text>
                </g>
                
                <!-- Notifications Table -->
                <g id="notifications-table">
                    <rect x="1000" y="770" width="260" height="220" fill="#e1f5fe" stroke="#03a9f4" stroke-width="2" rx="4"/>
                    <rect x="1000" y="770" width="260" height="30" fill="#03a9f4"/>
                    <text x="1130" y="790" text-anchor="middle" fill="white" font-weight="bold">notifications</text>
                    <text x="1010" y="820" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="1010" y="840" font-size="12" fill="#3498db">ðŸ”— user_id: UUID</text>
                    <text x="1010" y="860" font-size="12">type: ENUM</text>
                    <text x="1010" y="880" font-size="12">title: VARCHAR(255)</text>
                    <text x="1010" y="900" font-size="12">message: TEXT</text>
                    <text x="1010" y="920" font-size="12">is_read: BOOLEAN</text>
                    <text x="1010" y="940" font-size="12">priority: ENUM</text>
                    <text x="1010" y="960" font-size="12">action_url: VARCHAR(255)</text>
                    <text x="1010" y="980" font-size="12">created_at: TIMESTAMP</text>
                </g>
                
                <!-- Audit Logs Table -->
                <g id="audit-logs-table">
                    <rect x="350" y="770" width="250" height="200" fill="#fff8e1" stroke="#ffc107" stroke-width="2" rx="4"/>
                    <rect x="350" y="770" width="250" height="30" fill="#ffc107"/>
                    <text x="475" y="790" text-anchor="middle" fill="white" font-weight="bold">audit_logs</text>
                    <text x="360" y="820" font-size="12">ðŸ”‘ id: UUID</text>
                    <text x="360" y="840" font-size="12" fill="#3498db">ðŸ”— user_id: UUID</text>
                    <text x="360" y="860" font-size="12">action: VARCHAR(100)</text>
                    <text x="360" y="880" font-size="12">entity_type: VARCHAR(50)</text>
                    <text x="360" y="900" font-size="12">entity_id: UUID</text>
                    <text x="360" y="920" font-size="12">old_values: JSON</text>
                    <text x="360" y="940" font-size="12">new_values: JSON</text>
                    <text x="360" y="960" font-size="12">ip_address: VARCHAR(45)</text>
                    <text x="360" y="980" font-size="12">created_at: TIMESTAMP</text>
                </g>
                
                <!-- Relationships -->
                <g stroke="#666" stroke-width="2" fill="none">
                    <!-- Users to Patient Profiles -->
                    <path d="M 270 150 L 350 150" marker-end="url(#arrow)"/>
                    
                    <!-- Users to Doctor Profiles -->
                    <path d="M 270 150 L 320 150 L 320 150 L 650 150" marker-end="url(#arrow)"/>
                    
                    <!-- Patient Profiles to Appointments -->
                    <path d="M 470 330 L 470 420" marker-end="url(#many)"/>
                    
                    <!-- Doctor Profiles to Appointments -->
                    <path d="M 780 370 L 780 400 L 610 400 L 610 470" marker-end="url(#many)"/>
                    
                    <!-- Appointments to Consultations -->
                    <path d="M 610 570 L 700 570" marker-end="url(#arrow)"/>
                    
                    <!-- Consultations to Prescriptions -->
                    <path d="M 950 540 L 1000 540" marker-end="url(#arrow)"/>
                    
                    <!-- Patient Profiles to Medical Records -->
                    <path d="M 350 200 L 300 200 L 300 350 L 175 350 L 175 420" marker-end="url(#many)"/>
                    
                    <!-- Appointments to Payments -->
                    <path d="M 350 650 L 300 650 L 300 700 L 175 700 L 175 770" marker-end="url(#arrow)"/>
                    
                    <!-- Doctor Profiles to Time Slots -->
                    <path d="M 780 370 L 780 400 L 825 400 L 825 770" marker-end="url(#many)"/>
                    
                    <!-- Users to Notifications -->
                    <path d="M 160 250 L 160 300 L 1130 300 L 1130 770" marker-end="url(#many)"/>
                    
                    <!-- Users to Audit Logs -->
                    <path d="M 160 250 L 160 300 L 475 300 L 475 770" marker-end="url(#many)"/>
                    
                    <!-- Patient Profiles to Prescriptions -->
                    <path d="M 590 200 L 640 200 L 640 380 L 1130 380 L 1130 420" marker-end="url(#many)"/>
                    
                    <!-- Doctor Profiles to Prescriptions -->
                    <path d="M 910 210 L 960 210 L 960 380 L 1100 380 L 1100 420" marker-end="url(#many)"/>
                </g>
            </svg>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <span style="color: #f39c12;">ðŸ”‘</span>
                <span>Primary Key</span>
            </div>
            <div class="legend-item">
                <span style="color: #3498db;">ðŸ”—</span>
                <span>Foreign Key</span>
            </div>
            <div class="legend-item">
                <svg width="30" height="10">
                    <line x1="0" y1="5" x2="20" y2="5" stroke="#666" stroke-width="2" marker-end="url(#arrow)"/>
                </svg>
                <span>One-to-One/Many</span>
            </div>
            <div class="legend-item">
                <svg width="30" height="10">
                    <line x1="0" y1="5" x2="20" y2="5" stroke="#666" stroke-width="2" marker-end="url(#many)"/>
                </svg>
                <span>One-to-Many</span>
            </div>
        </div>
        
        <div class="section">
            <h2>Key Database Design Decisions</h2>
            <div class="table-details">
                <div class="table-card">
                    <h3>ðŸ”’ Security Considerations</h3>
                    <ul>
                        <li>Passwords stored as bcrypt hashes</li>
                        <li>Sensitive data encrypted at rest</li>
                        <li>PII fields marked for GDPR compliance</li>
                        <li>Audit logs for all data modifications</li>
                        <li>Role-based access control at database level</li>
                    </ul>
                </div>
                
                <div class="table-card">
                    <h3>ðŸš€ Performance Optimizations</h3>
                    <ul>
                        <li>Indexes on all foreign keys</li>
                        <li>Composite indexes for common queries</li>
                        <li>JSON columns for flexible data structures</li>
                        <li>Partitioning for large tables (appointments, logs)</li>
                        <li>Read replicas for reporting queries</li>
                    </ul>
                </div>
                
                <div class="table-card">
                    <h3>ðŸ“Š Data Types & Constraints</h3>
                    <ul>
                        <li>UUID for all primary keys (distributed systems)</li>
                        <li>ENUM types for controlled vocabularies</li>
                        <li>JSON for variable data structures</li>
                        <li>Appropriate varchar lengths for optimization</li>
                        <li>Check constraints for data validation</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Table Relationships Summary</h2>
            <div class="table-details">
                <div class="table-card">
                    <h3>Core Relationships</h3>
                    <table>
                        <tr>
                            <th>Parent Table</th>
                            <th>Child Table</th>
                            <th>Relationship</th>
                        </tr>
                        <tr>
                            <td>users</td>
                            <td>patient_profiles</td>
                            <td>One-to-One</td>
                        </tr>
                        <tr>
                            <td>users</td>
                            <td>doctor_profiles</td>
                            <td>One-to-One</td>
                        </tr>
                        <tr>
                            <td>patient_profiles</td>
                            <td>appointments</td>
                            <td>One-to-Many</td>
                        </tr>
                        <tr>
                            <td>doctor_profiles</td>
                            <td>appointments</td>
                            <td>One-to-Many</td>
                        </tr>
                        <tr>
                            <td>appointments</td>
                            <td>consultations</td>
                            <td>One-to-One</td>
                        </tr>
                        <tr>
                            <td>consultations</td>
                            <td>prescriptions</td>
                            <td>One-to-Many</td>
                        </tr>
                    </table>
                </div>
                
                <div class="table-card">
                    <h3>Supporting Relationships</h3>
                    <table>
                        <tr>
                            <th>Parent Table</th>
                            <th>Child Table</th>
                            <th>Relationship</th>
                        </tr>
                        <tr>
                            <td>patient_profiles</td>
                            <td>medical_records</td>
                            <td>One-to-Many</td>
                        </tr>
                        <tr>
                            <td>appointments</td>
                            <td>payments</td>
                            <td>One-to-One</td>
                        </tr>
                        <tr>
                            <td>doctor_profiles</td>
                            <td>time_slots</td>
                            <td>One-to-Many</td>
                        </tr>
                        <tr>
                            <td>users</td>
                            <td>notifications</td>
                            <td>One-to-Many</td>
                        </tr>
                        <tr>
                            <td>users</td>
                            <td>audit_logs</td>
                            <td>One-to-Many</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>Index Strategy</h2>
            <div class="table-details">
                <div class="table-card">
                    <h3>Primary Indexes</h3>
                    <ul>
                        <li><code>users</code>: email (unique), role</li>
                        <li><code>appointments</code>: patient_id, doctor_id, appointment_date, status</li>
                        <li><code>consultations</code>: appointment_id (unique)</li>
                        <li><code>prescriptions</code>: patient_id, doctor_id, created_at</li>
                        <li><code>medical_records</code>: patient_id, record_type</li>
                    </ul>
                </div>
                
                <div class="table-card">
                    <h3>Composite Indexes</h3>
                    <ul>
                        <li><code>appointments</code>: (doctor_id, appointment_date, status)</li>
                        <li><code>appointments</code>: (patient_id, appointment_date)</li>
                        <li><code>time_slots</code>: (doctor_id, day_of_week, is_available)</li>
                        <li><code>notifications</code>: (user_id, is_read, created_at)</li>
                        <li><code>audit_logs</code>: (entity_type, entity_id, created_at)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>